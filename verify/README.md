# Builtin Atomics Verification

## Prerequisites

To run the verification scripts, one needs to have *Ruby*, *Rust*, *Boogie* and *Z3* installations. To run the verification with parallelism, the `parallel` gem is also needed and can be installed by 
```
    gem install parallel
```

## Generating the assembly file

The assembly file with the builtin atomics can be generated by: 

```
    aarch64-linux-gnu-gcc -DVATOMIC_BUILTINS -O2 -x c include/vsync/atomic.h -Iinclude -fkeep-inline-functions -S -mno-outline-atomics -o atomics.s
```
 The `atomics.s` file should be located in the `armv8` subfolder

 ## Running the verification

 To start the verification for the builtin armv8 atomics, you need a list of functions that should be checked. You can find the lists organized by prefixes in the `lists` subfolder. 

 The verification for a specific `list.txt` can be started by: 

 ```
    ruby verify_all.rb -a armv8 -s list.txt
 ```

A specific function `func` can be verified by (git specifying that the boogie files should be generated in `output_folder`):

```
    ruby verify_all.rb -a armv8 -f func -o output_folder
```
